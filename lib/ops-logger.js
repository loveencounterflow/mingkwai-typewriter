// Generated by CoffeeScript 2.3.2
(function() {
  'use strict';
  var CND, XE, alert, badge, debug, help, info, jr, rpr, urge, warn, whisper;

  //###########################################################################################################
  CND = require('cnd');

  rpr = CND.rpr;

  badge = '明快打字机/OPS-LOGGER';

  debug = CND.get_logger('debug', badge);

  alert = CND.get_logger('alert', badge);

  whisper = CND.get_logger('whisper', badge);

  warn = CND.get_logger('warn', badge);

  help = CND.get_logger('help', badge);

  urge = CND.get_logger('urge', badge);

  info = CND.get_logger('info', badge);

  //...........................................................................................................
  ({jr} = CND);

  XE = require('../lib/xemitter');

  // { inspect, }              = require 'util'
  // xrpr                      = ( x ) -> inspect x, { colors: yes, breakLength: Infinity, maxArrayLength: Infinity, depth: Infinity, }

  //-----------------------------------------------------------------------------------------------------------
  this.log_all_events = function(key, d) {
    var logger, message, ref, v;
    // whisper 'µ99823', key #, jr d
    v = (ref = d.value) != null ? ref : {};
    logger = jQuery('#logger');
    while (logger.children().length > 10) {
      (logger.find(':first-child')).remove();
    }
    message = rpr(v);
    // message = ( k for k         of d.value                ).join ', '
    // message = switch key
    //   when '^kblevel' then  ( k for k, toggle of S.kblevels when toggle ).join ', '
    //   else                  ( k for k         of d.value                ).join ', '
    //.........................................................................................................
    logger.append(`<div>${Date.now()}: ${rpr(key)}: ${message}</div>`);
    console.log('µ33499', Date.now(), key, d);
    // if ( kblevels = d.value?.S?.kblevels )
    //   logger.append ( "<div>#{Date.now()}: kblevels: #{rpr kblevels}</div>" )
    logger.scrollTop(logger[0].scrollHeight);
    //.........................................................................................................
    return null;
  };

  //-----------------------------------------------------------------------------------------------------------
  this.log = function(...P) {
    /* TAINT code duplication */
    var logger, p, text;
    text = ((function() {
      var i, len, results;
      results = [];
      for (i = 0, len = P.length; i < len; i++) {
        p = P[i];
        results.push(CND.isa_text(p) ? p : rpr(p));
      }
      return results;
    })()).join(' ');
    logger = jQuery('#logger');
    while (logger.children().length > 10) {
      (logger.find(':first-child')).remove();
    }
    /* TAINT should escape text (or accept HTML?) */
    logger.append(`<div>${Date.now()}: ${text}</div>`);
    console.log('µ33499', Date.now(), text);
    logger.scrollTop(logger[0].scrollHeight);
    return null;
  };

}).call(this);

//# sourceMappingURL=ops-logger.js.map
