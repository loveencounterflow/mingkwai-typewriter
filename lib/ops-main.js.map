{
  "version": 3,
  "file": "ops-main.js",
  "sourceRoot": "..",
  "sources": [
    "src/ops-main.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n'use strict'\n\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = '明快打字机/OPS-MAKESHIFT'\ndebug                     = CND.get_logger 'debug',     badge\nalert                     = CND.get_logger 'alert',     badge\nwhisper                   = CND.get_logger 'whisper',   badge\nwarn                      = CND.get_logger 'warn',      badge\nhelp                      = CND.get_logger 'help',      badge\nurge                      = CND.get_logger 'urge',      badge\ninfo                      = CND.get_logger 'info',      badge\nKEYS                      = require '../lib/keys'\nT                         = require '../lib/templates'\nPATH                      = require 'path'\nFS                        = require 'fs'\n#...........................................................................................................\nrequire                   '../lib/exception-handler'\n# require                   '../lib/kana-input'\n# require                   '../lib/kanji-input'\n#...........................................................................................................\nPD                        = require 'pipedreams'\n{ jr, }                   = CND\n{ after, }                = CND.suspend\ndefer                     = setImmediate\n{ $\n  $async }                = PD\n# XE                        = null\nXE                        = require '../lib/xemitter'\n{ inspect, }              = require 'util'\nxrpr                      = ( x ) -> inspect x, { colors: yes, breakLength: Infinity, maxArrayLength: Infinity, depth: Infinity, }\n\n\n#===========================================================================================================\n#\n#-----------------------------------------------------------------------------------------------------------\n@always_focus_editor = ->\n  ### TAINT this method inhibits selecting, copying text from logger, candidates ###\n  @always_focus_editor = -> ### do not add any more handlers with this method after first call ###\n  ( jQuery 'div.CodeMirror-code' ).on 'blur', -> @focus()\n  ( jQuery 'div.CodeMirror-code' ).focus()\n  return null\n\n\n\n#===========================================================================================================\n# FOCUSFRAME\n#-----------------------------------------------------------------------------------------------------------\n@toggle_focusframe = ->\n  # @log \"S.focus_is_candidates: #{S.focus_is_candidates}\"\n  if S.focus_is_candidates  then  @focusframe_to_editor()\n  else                            @focusframe_to_candidates()\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@focusframe_to_editor = ->\n  @_focusframe_to 'leftbar'\n  S.focus_is_candidates = false\n\n#-----------------------------------------------------------------------------------------------------------\n@focusframe_to_candidates = ->\n  @_focusframe_to 'rightbar'\n  S.focus_is_candidates = true\n\n#-----------------------------------------------------------------------------------------------------------\n@_focusframe_to = ( target ) ->\n  # target      = jQuery( document.activeElement )\n  target      = jQuery target if CND.isa_text target\n  ff          = jQuery 'focusframe'\n  return if target.length < 1\n  # ff.offset     target.offset()\n  # ff.width      target.width()\n  # ff.height     target.height()\n  tgto        = target.offset()\n  return unless tgto?\n  left    = tgto.left       - 1\n  top     = tgto.top        - 1\n  width   = target.width()  + 2\n  height  = target.height() + 2\n  ff.animate { left, top, width, height, }, 100\n  return null\n\n#===========================================================================================================\n# WINDOW\n#-----------------------------------------------------------------------------------------------------------\n@get_window = -> ( require 'electron' ).remote.getCurrentWindow()\n\n\n\n#===========================================================================================================\n# APP INITIALIZATION\n#-----------------------------------------------------------------------------------------------------------\n@init = ->\n  # { remote, }               = require 'electron'\n  # XE                        = remote.require './xemitter'\n  #.........................................................................................................\n  S.candidates          =\n    jq:           jQuery '#candidates'\n    selected:\n      id:         null\n  S.focus_is_candidates = false\n  #.........................................................................................................\n  ### Initialize CodeMirror ###\n  S.codemirror.editor = CodeMirror.fromTextArea ( jQuery '#codemirror' )[ 0 ], S.codemirror.settings\n  S.codemirror.editor.setSize null, '100%'\n  S.codemirror.editor.on 'inputRead', ( me, change ) -> XE.emit PD.new_event '^raw-input', { change, }\n  XE.listen_to '^ignore-delete', -> S.ignore_delete += +1\n  S.codemirror.editor.on 'change', ( me, change ) ->\n    ### TAINT when inserting results, will there be a change event? ###\n    return null unless change.origin is '+delete'\n    ### ignore event if it has been generated: ###\n    if S.ignore_delete > 0\n      S.ignore_delete += -1\n      return null\n    XE.emit PD.new_event '^raw-input', { change, }\n  @always_focus_editor()\n  #.........................................................................................................\n  # S.codemirror.editor.on 'beforeChange',    ( me, change      ) -> whisper 'µ66653', 'beforeChange',  jr change\n  # S.codemirror.editor.on 'change',          ( me, change      ) -> whisper 'µ66653', 'change',        jr change\n  # S.codemirror.editor.on 'changes',         ( me, changes     ) -> whisper 'µ66653', 'changes',       jr changes\n  # S.codemirror.editor.on 'cursorActivity',  ( me              ) -> whisper 'µ66653', 'cursorActivity'\n  # S.codemirror.editor.on 'keyHandled',      ( me, name, event ) -> whisper 'µ66653', 'keyHandled',    jr name\n  # S.codemirror.editor.on 'inputRead',       ( me, change      ) -> whisper 'µ66653', 'inputRead',     jr change\n  #.........................................................................................................\n  ### Register key and mouse events ###\n  KEYS.generate_keboard_events jQuery 'html'\n  # KEYS.register 'axis', 'vertical',     ( uie )   => @on_vertical_navigation  uie\n  # KEYS.register 'slot', 'Enter',        ( uie )   => @on_add_selection        uie\n  @add_menu()\n  @restore_documents()\n  @focusframe_to_editor()\n  @set_codemirror_keybindings()\n  @set_app_keybindings()\n  @set_event_bindings()\n  @log 'µ49884', ( k for k of @ ).sort()\n  #.........................................................................................................\n  ### Detect resizing events: ###\n  ### TAINT won't work when panes are shifted (probably) ###\n  ( jQuery window ).on 'resize', =>\n    debug \"resize window\"\n    @index_candidates()\n    return null\n  return null\n\n\n\n\n"
  ]
}