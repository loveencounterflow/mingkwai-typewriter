{
  "version": 3,
  "file": "using-icql-with-sqlite.js",
  "sourceRoot": "../..",
  "sources": [
    "src/experiments/using-icql-with-sqlite.coffee"
  ],
  "names": [],
  "mappings": "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",
  "sourcesContent": [
    "\n\n'use strict'\n\n############################################################################################################\nCND                       = require 'cnd'\nrpr                       = CND.rpr\nbadge                     = 'IME/EXPERIMENTS/ICQL+SQLITE'\ndebug                     = CND.get_logger 'debug',     badge\nwarn                      = CND.get_logger 'warn',      badge\ninfo                      = CND.get_logger 'info',      badge\nurge                      = CND.get_logger 'urge',      badge\nhelp                      = CND.get_logger 'help',      badge\nwhisper                   = CND.get_logger 'whisper',   badge\necho                      = CND.echo.bind CND\n#...........................................................................................................\nPATH                      = require 'path'\n# FS                        = require 'fs'\nPD                        = require 'pipedreams'\n{ $\n  $async\n  select }                = PD\n{ assign\n  jr }                    = CND\n#...........................................................................................................\njoin_path                 = ( P... ) -> PATH.resolve PATH.join P...\nboolean_as_int            = ( x ) -> if x then 1 else 0\n{ inspect, }              = require 'util'\nxrpr                      = ( x ) -> inspect x, { colors: yes, breakLength: Infinity, maxArrayLength: Infinity, depth: Infinity, }\nxrpr2                     = ( x ) -> inspect x, { colors: yes, breakLength: 80,       maxArrayLength: Infinity, depth: Infinity, }\n#...........................................................................................................\nICQL                      = require 'icql'\nINTERTYPE                 = require '../types'\n\n\n#-----------------------------------------------------------------------------------------------------------\nf = ( S ) ->\n  source    = PD.new_push_source()\n  pipeline  = []\n  pipeline.push source\n  pipeline.push PD.$show()\n  pipeline.push PD.$drain()\n  PD.pull pipeline...\n\n#-----------------------------------------------------------------------------------------------------------\n@get_settings = ->\n  ### TAINT path within node_modules might differ ###\n  ### TAINT extensions should conceivably be configured in `*.icql` file or similar ###\n  # R.db_path   = join_path __dirname, '../../db/data.db'\n  R                 = {}\n  R.connector       = require 'better-sqlite3'\n  R.sqlitemk_path   = join_path __dirname, '../../../../sqlite-for-mingkwai-ime'\n  R.db_path         = join_path __dirname, '../../src/experiments/using-intercourse-with-sqlite.db'\n  R.icql_path       = join_path __dirname, '../../src/experiments/using-intercourse-with-sqlite.icql'\n  return R\n\n#-----------------------------------------------------------------------------------------------------------\n@new_db = ->\n  settings  = @get_settings()\n  db        = ICQL.bind settings\n  # db        = await ICQL.bind settings\n  db.$.load join_path settings.sqlitemk_path, 'extensions/csv.so'\n  db.$.load join_path settings.sqlitemk_path, 'extensions/spellfix.so'\n  db.$.load join_path settings.sqlitemk_path, 'extensions/regexp.so'\n  db.$.load join_path settings.sqlitemk_path, 'extensions/series.so'\n  db.$.load join_path settings.sqlitemk_path, 'extensions/nextchar.so'\n  # db.$.load join_path settings.sqlitemk_path, 'extensions/stmt.so'\n  db.$.pragma 'foreign_keys = on'\n  db.$.pragma 'synchronous = off' ### see https://sqlite.org/pragma.html#pragma_synchronous ###\n  # info row for row in db.$.all_rows db.$.catalog()\n  clear_count = db.$.clear()\n  info \"deleted #{clear_count} objects\"\n  @create_db_functions db\n  # @add_functions db\n  db.import_table_unames()\n  db.import_table_uname_tokens()\n  db.import_table_unicode_test()\n  db.create_view_unicode_test_with_end_markers()\n  db.fts5_create_and_populate_token_tables()\n  db.spellfix_create_editcosts()\n  db.spellfix_create_and_populate_token_tables()\n  db.spellfix_populate_custom_codes()\n  return db\n\n#-----------------------------------------------------------------------------------------------------------\n@create_db_functions = ( db ) ->\n  # db.$.function 'add_spellfix_confusable', ( a, b ) ->\n  # db.$.function 'spellfix1_phonehash', ( x ) ->\n  #   debug '23363', x\n  #   return x.toUpperCase()\n  #.........................................................................................................\n  db.$.function 'echo', { deterministic: false, varargs: true }, ( P... ) ->\n    urge ( CND.grey 'DB' ), P...\n    return null\n  #.........................................................................................................\n  db.$.function 'e', { deterministic: false, varargs: false }, ( x ) ->\n    urge ( CND.grey 'DB' ), rpr x\n    return x\n  #.........................................................................................................\n  db.$.function 'plus', { deterministic: true, varargs: false }, ( a, b ) ->\n    debug '33444', a, b\n    return a + b\n  #.........................................................................................................\n  db.$.function 'contains_word', { deterministic: true, varargs: false }, ( text, probe ) ->\n    return if ( ( ' ' + text + ' ' ).indexOf ' ' + probe + ' ' ) > -1 then 1 else 0\n  #.........................................................................................................\n  db.$.function 'get_words', { deterministic: true, varargs: false }, ( text ) ->\n    JSON.stringify ( word for word in text.split /\\s+/ when word isnt '' )\n  #.........................................................................................................\n  db.$.function 'get_nth_word', { deterministic: true, varargs: false }, ( text, nr ) ->\n    ### NB SQLite has no string aggregation, no string splitting, and in general does not implement\n    table-returning user-defined functions (except in C, see the `prefixes` extension). Also, you can't\n    modify tables from within a UDF because the connection is of course busy executing the UDF.\n\n    As a consequence, it is well-nigh impossible to split strings to rows in a decent manner. You could\n    probably write a 12-liner with a recursive CTE each time you want to split a string. Unnecessary to\n    mention that SQLite does not support putting *that* thing into a UDF (because those can't return\n    anything except a single atomic value). It's a whack-a-mole game of missing pieces really.\n\n    The only ways out that I can see are either (1) preparing your data in the application code in such a\n    way that you never have to perform string splitting in the DB, or else (2) write functions like this\n    that accept a regular argument and a counter, query with a reasonable maximum counter value, and discard\n    all invalid rows:\n\n    ```sql\n    select\n        get_nth_word( 'helo world whassup', gs.value ) as word\n      from generate_series( 1, 10 ) as gs\n      where word is not null;\n    ```\n\n    Performance of this particular function could be improved by adding a small, short-lived cache, but I\n    guess that will be counterproductive as long as the texts to split are unlikely to contain more than a\n    very few words.\n\n    **Update** Turns out the `json1` extension can help out:\n\n    ```coffee\n    db.$.function 'get_words', { deterministic: true, varargs: false }, ( text ) ->\n      JSON.stringify ( word for word in text.split /\\s+/ when word isnt '' )\n    ```\n\n    ```sql\n    select\n        id    as nr,\n        value as word\n      from\n        json_each(\n          json(\n            get_words( 'helo world these are many words' ) ) );\n    ```\n\n\n    ###\n    parts = text.split /\\s+/\n    return parts[ nr - 1 ] ? null\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_fts5_token_phrases = ( db ) ->\n  #.........................................................................................................\n  whisper '-'.repeat 108\n  urge 'demo_fts5_token_phrases'\n  token_phrases = [\n    'latin alpha'\n    'latin alpha small'\n    'latin alpha capital'\n    'greek alpha'\n    'greek alpha small'\n    'cyrillic small a'\n    ]\n  for q in token_phrases\n    urge rpr q\n    info ( xrpr row ) for row from db.fts5_fetch_uname_token_matches { q, limit: 5, }\n  #.........................................................................................................\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_fts5_broken_phrases = ( db ) ->\n  #.........................................................................................................\n  whisper '-'.repeat 108\n  urge 'demo_fts5_broken_phrases'\n  cache           = {}\n  broken_phrases  = [\n    'latn alp'\n    'latn alp smll'\n    'latn alp cap'\n    'greek alpha'\n    'cap greek alpha'\n    'greek alpha small'\n    'cyrillic small a'\n    'ktkn'\n    'katakana'\n    'hirag no'\n    'no'\n    'xxx'\n    'istanbul'\n    'capital'\n    'mycode'\n    '123'\n    '^'\n    '´'\n    '`'\n    '\"'\n    '~'\n    '~ a'\n    '~ a small'\n    '~ a capital'\n    '_'\n    '-'\n    '~~'\n    '%'\n    '_'\n    '~~'\n    '%'\n    '%0'\n    '%0 sign'\n    'kxr'\n    'kxr tree'\n    'n14 circled'\n    'circled n14'\n    'fourteen circled'\n    '- l'\n    ]\n  ### TAINT `initials` should be in `db.$.settings` ###\n  initials  = 2\n  tokens    = []\n  for broken_phrase in broken_phrases\n    #.......................................................................................................\n    for attempt in broken_phrase.split /\\s+/\n      if ( hit = cache[ attempt ] ) is undefined\n        hit               = db.$.first_value db.match_uname_tokens_spellfix { q: attempt, initials, limit: 1, }\n        cache[ attempt ]  = hit ? null\n        # debug '27762', attempt, hit\n      tokens.push hit if hit?\n    #.......................................................................................................\n    debug tokens\n    if tokens.length < 1\n      warn \"no token matches for #{rpr broken_phrase}\"\n      continue\n    #.......................................................................................................\n    q = tokens.join ' '\n    tokens.length = 0\n    #.......................................................................................................\n    urge ( CND.white broken_phrase ), ( CND.grey '-->' ), ( CND.orange rpr q )\n    info ( xrpr row ) for row from db.fts5_fetch_uname_token_matches { q, limit: 5, }\n  #.........................................................................................................\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_uname_tokens = ( db ) ->\n  info ( xrpr row ) for row from db.$.query \"\"\"select * from uname_tokens;\"\"\"\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_spellfix = ( db ) ->\n  whisper '-'.repeat 108\n  urge 'demo_spellfix'\n  # info ( xrpr row ) for row from db.$.query 'select * from spellfix_editcosts;'\n  # db.$.execute \"\"\"update spellfix_uname_tokens_vocab set k2 = upper( word );\"\"\"\n  # db.$.execute \"\"\"update spellfix_uname_tokens_vocab set k2 = 'CDACM';\"\"\"\n  # info ( xrpr row ) for row from db.$.query \"\"\"select * from spellfix_uname_tokens_vocab where word regexp '^[^0-9]' limit 30;\"\"\"\n  words = [\n    # 'were'\n    # 'whether'\n    # 'whater'\n    # 'thosand'\n    # 'fancy'\n    # 'fort'\n    # 'trof'\n    # 'latn'\n    # 'cap'\n    # 'letr'\n    # 'alif'\n    # 'hirag'\n    # 'hrg'\n    # 'hrgn'\n    # 'cyr'\n    # 'grk'\n    # 'grek'\n    # 'no'\n    # 'kata'\n    # 'katak'\n    # 'ktkn'\n    # 'katkn'\n    # 'ktkna'\n    # 'ktakn'\n    # 'standard'\n    # 'hiero'\n    # 'egt'\n    'egyp'\n    'hgl'\n    'xxx'\n    'istanbul'\n    'capital'\n    'mycode'\n    '123'\n    '^'\n    '´'\n    '`'\n    '\"'\n    '~'\n    '_'\n    '-'\n    '~~'\n    '%'\n    '_'\n    '~~'\n    '%'\n    '%0'\n    'kxr'\n    ]\n  ### TAINT `initials` should be in `db.$.settings` ###\n  initials = 2\n  t0 = Date.now()\n  for q in words\n    qphonehash = db.$.first_value db.get_spellfix1_phonehash { q, }\n    # for row from db.match_uname_tokens_spellfix_with_scores { q, initials, limit: 15, }\n    #   debug '----', q, 'I', initials, 'S', row.score, 'L', row.matchlen, 'D', row.distance, row.source, row.qphonehash, row.wphonehash, row.word\n    hits = db.$.all_first_values db.match_uname_tokens_spellfix { q, initials, limit: 5, }\n    hits = hits.join ', '\n    info \"#{q} (#{qphonehash}) --> #{hits}\"\n  t1  = Date.now()\n  dt  = t1 - t0\n  tps = dt / words.length\n  urge \"took #{dt} ms (#{tps.toFixed 1} ms per search)\"\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_json = ( db ) ->\n  whisper '-'.repeat 108\n  urge 'demo_json'\n  info db.$.all_rows db.$.query \"\"\"\n    select\n        x.words                       as words,\n        json_array_length ( x.words ) as word_count\n      from ( select\n        json( get_words( 'helo world these are many words' ) ) as words ) as x\n    ;\"\"\"\n  whisper '---------------------------------------------'\n  info row for row from db.$.query \"\"\"\n    select\n        id,\n        -- key,\n        type,\n        value\n      from json_each( json( get_words( 'helo world these are many words' ) ) )\n    ;\"\"\"\n  whisper '---------------------------------------------'\n  info row for row from db.$.query \"\"\"\n    select\n        id,\n        -- key,\n        type,\n        value\n      from json_each( json( '[1,1.5,1e6,true,false,\"x\",null,{\"a\":42},[1,2,3]]' ) )\n    ;\"\"\"\n  whisper '---------------------------------------------'\n  info row for row from db.$.query \"\"\"\n    select json_group_array( names.name )\n      from (\n        select null as name where false   union all\n        select 'alice'                    union all\n        select 'bob'                      union all\n        select 'carlito'                  union all\n        select 'domian'                   union all\n        select 'franz'                    union all\n        select null where false\n        ) as names\n    ;\"\"\"\n  whisper '---------------------------------------------'\n  info rpr JSON.parse db.$.first_value db.$.query \"\"\"\n    select\n        json_group_object( staff.name, staff.extension ) as staff\n      from (\n        select null as name, null as extension where false  union all\n        select 'alice',   123                               union all\n        select 'bob',     150                               union all\n        select 'carlito', 177                               union all\n        select 'domian',  204                               union all\n        select 'franz',   231                               union all\n        select null, null where false\n        ) as staff\n    ;\"\"\"\n  whisper '---------------------------------------------'\n  info xrpr row for row from db.$.query \"\"\"\n    select\n        id                            as nr,\n        replace( fullkey, '$', '' )   as path,\n        key                           as key,\n        atom                          as value\n      from json_tree( json( '[1,1.5,1e6,true,false,\"x\",null,{\"a\":42,\"c\":[1,{\"2\":\"sub\"},3]}]' ) ) as t\n      where t.fullkey != '$'\n    ;\"\"\"\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_catalog = ( db ) ->\n  for row from db.$.catalog()\n    entry = []\n    entry.push CND.grey   row.type\n    entry.push CND.white  row.name\n    entry.push CND.yellow \"(#{row.tbl_name})\" if row.name isnt row.tbl_name\n    info entry.join ' '\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_longest_matching_prefix = ( db ) ->\n  count = db.$.first_value db.$.query \"\"\"select count(*) from uname_tokens;\"\"\"\n  info \"selecting from #{count} entries in uname_tokens\"\n  probes = [\n    'gr'\n    'alpha'\n    'beta'\n    'c'\n    'ca'\n    'cap'\n    'capi'\n    'omega'\n    'circ'\n    'circle'\n    ]\n  for probe in probes\n    info ( CND.grey '--------------------------------------------------------' )\n    nr = 0\n    #.......................................................................................................\n    for row from db.longest_matching_prefix_in_uname_tokens { q: probe, limit: 10, }\n      nr += +1\n      # info probe, ( xrpr row )\n      info ( CND.grey nr ), ( CND.grey row.delta_length ), ( CND.blue probe ), ( CND.grey '->' ), ( CND.lime row.uname_token )\n    #.......................................................................................................\n    table = 'uname_tokens'\n    field = 'uname_token'\n    chrs  = Array.from db.$.first_value db.next_characters { prefix: probe, table, field, }\n    info probe, '...', ( chrs.join ' ' )\n  #.........................................................................................................\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_nextchr = ( db ) ->\n  #.........................................................................................................\n  # whisper '-'.repeat 108\n  # for row from db.$.query \"\"\"select * from unicode_test;\"\"\"\n  #   info ( xrpr row )\n  #.........................................................................................................\n  whisper '-'.repeat 108\n  probes = [\n    '-'\n    'っ'\n    'か'\n    '\\\\'\n    'ku'\n    'a'\n    'x' ]\n  # table = 'unicode_test'\n  table = 'unicode_test_with_end_markers'\n  field = 'word'\n  for probe in probes\n    chrs  = Array.from db.$.first_value db.next_characters { prefix: probe, table, field, }\n    info probe, '...', ( chrs.join ' ' )\n  #.........................................................................................................\n  return null\n\n#-----------------------------------------------------------------------------------------------------------\n@demo_edict2u = ( db ) ->\n  # debug INTERTYPE.all_keys_of db.$\n  db.create_table_edict2u()\n  console.time 'populate-edict2u'\n  path = join_path __dirname, '../../.cache/edict2u.sql'\n  help \"reading #{PATH.relative process.cwd(), path}\"\n  db.$.read path\n  console.timeEnd 'populate-edict2u'\n  #.........................................................................................................\n  return null\n\n\n\n############################################################################################################\nunless module.parent?\n  IME = @\n  do ->\n    db = IME.new_db()\n    # db = await IME.new_db()\n    # IME.demo_uname_tokens db\n    # IME.demo_fts5_token_phrases     db\n    # urge '33342', db.$.first_value db.$.query \"\"\"select plus( 34, 56 );\"\"\"\n    # urge '33342', db.$.first_value db.$.query \"\"\"select e( plus( 'here', 'there' ) );\"\"\"\n    # info row for row from db.$.query \"\"\"\n    #   select split( 'helo world whassup', s.value ) as word\n    #   from generate_series( 1, 10 ) as s\n    #   where word is not null\n    #   ;\n    #   \"\"\"\n    # IME.demo_spellfix                 db\n    # IME.demo_fts5_broken_phrases      db\n    # IME.demo_json                     db\n    # IME.demo_catalog                  db\n    # IME.demo_longest_matching_prefix  db\n    IME.demo_edict2u                  db\n    # IME.demo_nextchr                  db\n    return null\n\n\n"
  ]
}